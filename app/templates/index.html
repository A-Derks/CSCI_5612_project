{% extends "base.html" %}
{% block content %}
<section class="hero">
  <h1>{{ me.name }}</h1>
  <p>{{ me.tagline }}</p>
  <div class="cta">
    <a class="button outline" href="#contact">Contact</a>
  </div>
</section>

<section class="api-demo">
  <h2>API Demo (GitHub)</h2>
  <p>Enter a GitHub username to fetch recent repos via your FastAPI endpoint.</p>
  <form id="gh-form">
    <input id="gh-user" placeholder="e.g. tiangolo" required>
    <button class="button">Fetch</button>
  </form>
  <div id="gh-results" class="card" style="margin-top:.8rem;"></div>
</section>

<script>
document.getElementById('gh-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  const user = document.getElementById('gh-user').value.trim();
  const out = document.getElementById('gh-results');
  out.textContent = 'Loading...';
  try {
    const r = await fetch(`/api/github_repos?user=${encodeURIComponent(user)}&limit=5`);
    if(!r.ok) throw new Error('Request failed');
    const data = await r.json();
    if (!data.repos || !data.repos.length) { out.textContent = 'No repos found.'; return; }
    out.innerHTML = data.repos.map(r =>
      `<div class="repo"><a href="${r.url}" target="_blank" rel="noreferrer">${r.name}</a> ‚≠ê ${r.stars || 0} <small>${r.updated_at}</small></div>`
    ).join('');
  } catch (err) {
    out.textContent = 'Error: ' + err.message;
  }
});
</script>
{% endblock %}
